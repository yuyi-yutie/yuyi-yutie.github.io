<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>yuyi</title>
        <link>http://localhost:1313/</link>
        <description>Recent content on yuyi</description>
        <generator>Hugo -- gohugo.io</generator>
        <language>zh-cn</language>
        <copyright>yuyi</copyright>
        <lastBuildDate>Sun, 27 Apr 2025 00:00:00 +0000</lastBuildDate><atom:link href="http://localhost:1313/index.xml" rel="self" type="application/rss+xml" /><item>
        <title>Box-Muller变换－用随机数函数获取正态分布随机数</title>
        <link>http://localhost:1313/p/box-muller%E5%8F%98%E6%8D%A2%E7%94%A8%E9%9A%8F%E6%9C%BA%E6%95%B0%E5%87%BD%E6%95%B0%E8%8E%B7%E5%8F%96%E6%AD%A3%E6%80%81%E5%88%86%E5%B8%83%E9%9A%8F%E6%9C%BA%E6%95%B0/</link>
        <pubDate>Sun, 27 Apr 2025 00:00:00 +0000</pubDate>
        
        <guid>http://localhost:1313/p/box-muller%E5%8F%98%E6%8D%A2%E7%94%A8%E9%9A%8F%E6%9C%BA%E6%95%B0%E5%87%BD%E6%95%B0%E8%8E%B7%E5%8F%96%E6%AD%A3%E6%80%81%E5%88%86%E5%B8%83%E9%9A%8F%E6%9C%BA%E6%95%B0/</guid>
        <description>&lt;p&gt;原公式&lt;/p&gt;
$$
z_0 = \sqrt {(-2 \ln {u_1})} \times cos(2πu_2)
$$&lt;p&gt;其中u_1和u_2都是取值在(0,1)范围内的随机数&lt;/p&gt;
&lt;p&gt;则可得z_0为均值为0，标准差为1的正态分布随机数&lt;/p&gt;
&lt;p&gt;若要更改它的均值和方差，使用&lt;/p&gt;
$$
z_0&#39; = \bar{μ} + σ \times z_0
$$&lt;p&gt;即可&lt;/p&gt;
</description>
        </item>
        <item>
        <title>王朝与帝国序：台土</title>
        <link>http://localhost:1313/p/%E7%8E%8B%E6%9C%9D%E4%B8%8E%E5%B8%9D%E5%9B%BD%E5%BA%8F%E5%8F%B0%E5%9C%9F/</link>
        <pubDate>Tue, 15 Apr 2025 00:00:00 +0000</pubDate>
        
        <guid>http://localhost:1313/p/%E7%8E%8B%E6%9C%9D%E4%B8%8E%E5%B8%9D%E5%9B%BD%E5%BA%8F%E5%8F%B0%E5%9C%9F/</guid>
        <description>&lt;p&gt;历史不会倒退，时间不会停滞，王朝与帝国的往事不会波风沙抹去，不会因血流平静。&lt;/p&gt;
&lt;p&gt;生死云云，不过勉强之辞，人生而后死，何来存亡一说？握着江山的，是君王而不是人民，记述历史的，是学家却不是历者。生是一个人的，死便是一堆土，壮士与黄土，有其么区别，有甚么联系？好的，成了黄纸上的一片污绩，坏的，就埋到土里去喽！&lt;/p&gt;
&lt;p&gt;又有说啊，这九层之台，始于累土，没有土，哪来的台，台子是在土上建的，人是在台子下死的。究竟是土，哪有土翻到台子上的道理！台上的土会被良禽啄去狠狠地啄去，台子下的土，会被一层层埋上，永远翻不起来。&lt;/p&gt;
&lt;p&gt;书是人写的，却不写人，台子是人建的，却站不得人，这有甚么意思！可是土就是土， 土不会土出话来，更不会在台子上排出字来，过路的闲客在台子旁道一声漂亮，或趴着歇会，道一声舒坦，有土甚么事，都压在台子下了！&lt;/p&gt;
&lt;p&gt;无土哪有台，无下何来陛，历史会被尘封但不会散去，时间会迟到但不会缺席。王朝会颠覆，帝国会破败，土却依旧在台子下，讲着台子故事。&lt;/p&gt;
</description>
        </item>
        <item>
        <title>白眼狼传</title>
        <link>http://localhost:1313/p/%E7%99%BD%E7%9C%BC%E7%8B%BC%E4%BC%A0/</link>
        <pubDate>Mon, 14 Apr 2025 00:00:00 +0000</pubDate>
        
        <guid>http://localhost:1313/p/%E7%99%BD%E7%9C%BC%E7%8B%BC%E4%BC%A0/</guid>
        <description>&lt;p&gt;猎人早就知道它是狼了。&lt;/p&gt;
&lt;p&gt;但它不知道。&lt;/p&gt;
&lt;p&gt;“砰——”&lt;/p&gt;
&lt;p&gt;它听得出来，猎人这一枪命中了。猎人给它训练出的本能驱使它撒腿狂奔，子弹命中处涌出的血指引它找到了那头不幸的鹿。&lt;/p&gt;
&lt;p&gt;它扑了上去，撕扯下一大块肉来。&lt;/p&gt;
&lt;p&gt;“畜牲，别吃生肉！”猎人哼哧哼哧地追过来，抄起枪托砸它的头。&lt;/p&gt;
&lt;p&gt;他怕，这几年来他一直把它当成狗来养，不让他吃生肉，生怕它想起自己是头狼来，他知道，狼是不亲人的，说不定那天他就会在熟睡的时候被这它像这样咬下一大块肉来。&lt;/p&gt;
&lt;p&gt;但他得养他，市面上给猎人用的狗都太不实用了，这头狼或多或少能弥补他找不到合适的猎狗的难处，而且这家伙能胜任猎狗的职位，还能做的相当出色。&lt;/p&gt;
&lt;p&gt;但这几次狩猎，不论他怎么用枪托砸它的头，它还是会吃下几块生肉，他知道，它越来越渴望吃生肉了。&lt;/p&gt;
&lt;p&gt;越来越像头狼了。&lt;/p&gt;
&lt;p&gt;他得除掉它，就在今晚。&lt;/p&gt;
&lt;p&gt;当猎人拿着上膛的枪蹑手蹑脚走到狗舍（或者应该叫狼舍？）前时，它醒了，但它闻的出是猎人，它没有在意许多，作为一条狗，它理所应当地起身去迎接这位衣食父母。&lt;/p&gt;
&lt;p&gt;迎接它的是阴森森的枪口。&lt;/p&gt;
&lt;p&gt;它愣在那，这把枪它知道，每次见到猎人把这枪端起来瞄准时，它就得做好冲刺的准备，猎人把这叫做“狩猎”，但这次，往日指向它要追的猎物的方向的东西这次指向了它，难道这次狩猎，枪响之后，它要撕扯自己了？&lt;/p&gt;
&lt;p&gt;猎人这时也愣在原地，他不知道这头狼还觉得自己是狗，还会出来迎接他这位“主人”，但不管它把尾巴摇得多么热烈，他都得除掉它，为了今后一个时刻存在的——或许是不存在的——“隐患”。&lt;/p&gt;
&lt;p&gt;枪响了，但没有打中它的脑子，因为猎人愣的那一下，枪口也随着他的身体微微颤抖了一下，子弹带走了它的一只眼睛。&lt;/p&gt;
&lt;p&gt;猎人的身影在它眼中染上了一层血红。&lt;/p&gt;
&lt;p&gt;枪声在静夜中隆隆作响，这是猎人给它送别的礼炮，它多带走了猎人几颗子弹，在血红的山林中落荒而逃。&lt;/p&gt;
&lt;p&gt;“这畜牲吃了这么多子弹，又瞎了一只眼，想必也活不久。”猎人这样想，嘟囔着收了枪，又把那座简陋的狗舍拆了，拿来当明天的柴火烧。&lt;/p&gt;
&lt;p&gt;事实也确实如猎人所想，它没在林子里跑多久，便栽在了草地上，渗出的血在身下一片绿草中开出了一朵红莲。&lt;/p&gt;
&lt;p&gt;假如后来狼群没有闻到血味找到他们想象中的这头“猎物”，或许它会死于失血，哪怕不是这样，林子里也会有其他掠食动物来认领这顿美餐。&lt;/p&gt;
&lt;p&gt;“它是猎人养的那头狼！”&lt;/p&gt;
&lt;p&gt;“不能留他，狼群也曾养育过它，但它却反过来帮猎人猎杀狼群，白眼狼！”&lt;/p&gt;
&lt;p&gt;狼王还是决定留下了它，毕竟它还是一头狼，是狼就是狼群的一份子，作为狼王它深谙这点，它靠着自己作为老狼王的威望把它留了下来。&lt;/p&gt;
&lt;p&gt;在狼群里它恢复的很快，它的那只眼睛也从红色慢慢转白——它成了名副其实的白眼狼。&lt;/p&gt;
&lt;p&gt;刚进入狼群时，它还不能参与到狩猎中，它太虚弱了，跑起几步就得被体内的子弹拽回到地上，于是它成了狼群里的累赘——狼群显然不欢迎只进不出的家伙，他们纷纷叹息于老狼王的糊涂，也愤恨于这位白眼狼同胞过去给猎人当走狗的种种。&lt;/p&gt;
&lt;p&gt;狼群在一次狩猎中抢走了鬣狗的大餐，这次“抢劫”活动中参与抢劫的狼群成员都饱餐了一顿，又在回来后招呼着这位白眼狼同胞去享受或许已经开始腐烂的“大餐”。&lt;/p&gt;
&lt;p&gt;果不其然，现在这顿大餐是乌鸦在享用，白眼狼还是决定不去参与这场已经令它恶心的盛宴了，它开始往回走。&lt;/p&gt;
&lt;p&gt;“伙计，你附近有一头小羊，看到那边的林子吗，穿过去就能找到。”&lt;/p&gt;
&lt;p&gt;声音来自树上的一只乌鸦。&lt;/p&gt;
&lt;p&gt;来不及多想什么，饥饿驱使它跟随乌鸦的指引去找那只被父母抛下的小羊，“你为什么给我找食物？”&lt;/p&gt;
&lt;p&gt;“什么给你找食物，你吃了之后我就能吃了，我是一只被鸦群赶出来的乌鸦，鸦群在哪我就不能在哪，我给你找猎物，你给我留食物，鸦群会羡慕我的。”&lt;/p&gt;
&lt;p&gt;自此，白眼狼就离开了狼群而跟着乌鸦觅食，它终于不用忍受狼群中的种种非议了，但狼群也因此更加确定它是白眼狼——人类眼中的白眼狼，同样也是狼群眼中的白眼狼。&lt;/p&gt;
&lt;p&gt;乌鸦和白眼狼的合作很愉快，乌鸦很好地补足了白眼狼另一只眼的缺陷——作为一只更高维度的眼睛，它也显然比白眼狼原来的那只眼睛更为出色。好似猎人用白眼狼来代替猎狗一样，白眼狼用乌鸦代替它的那只眼睛。&lt;/p&gt;
&lt;p&gt;在一次精妙的猎杀大型猎物的合作狩猎成功后，山林里少了一团会跑的食物，多了一份保质期不久的即食盛宴。&lt;/p&gt;
&lt;p&gt;白眼狼在确认自己已经饱食到往后三天可以不用进食后，躺在一旁的草丛中开始休憩，把残羹留给乌鸦解决。&lt;/p&gt;
&lt;p&gt;不知是多久之后，白眼狼醒来时发现它的猎物上站着一圈的乌鸦，它也记得，帮它的那只乌鸦是游离在鸦群之外的，所以它认定，这个鸦群打扰到了它朋友（亦或是恩人）的用餐。&lt;/p&gt;
&lt;p&gt;它决定赶走它们。&lt;/p&gt;
&lt;p&gt;但它不知道的是，这些是乌鸦招呼来的好友亲朋，在它向它们展示它离开鸦群后立下的丰功伟绩时，白眼狼冲上来打碎了它的形象，来客们四散而飞，而有几只不幸的乌鸦则惨死在了白眼狼的牙下。&lt;/p&gt;
&lt;p&gt;它再也不和它合作了。&lt;/p&gt;
&lt;p&gt;它再一次地成为了“白眼狼”。&lt;/p&gt;
&lt;p&gt;在乌鸦离开后白眼狼还是能正常狩猎的，但它常常远远地看着享受它吃剩下的食物的鸦群，有着说不出来的感觉。&lt;/p&gt;
&lt;p&gt;再有白眼狼的事的时候是在很久之后了，猎人终于从市场里淘到了一条还算不错的猎犬，狼群深受其害，老狼王也在这段时间惨死在猎人枪下，新狼王白狼继位后找上了这位早已被狼群遗忘的白眼狼。&lt;/p&gt;
&lt;p&gt;白眼狼毫不犹豫地接下了反击猎人的任务。&lt;/p&gt;
&lt;p&gt;“砰——”&lt;/p&gt;
&lt;p&gt;一头四条腿的猎杀机器从枪声来处的草丛里射出来，扑上了那只身上淌着血的鹿的身上。“好样的，今天多给你吃点。”&lt;/p&gt;
&lt;p&gt;狗摇着尾巴表示高兴，虽然它应该不知道自己在高兴什么。&lt;/p&gt;
&lt;p&gt;它突然从那一团血腥味中闻到了一种其他的动物的味道——那是狼。&lt;/p&gt;
&lt;p&gt;白眼狼向猎犬猛扑了过去，就像那年它向它参与猎杀的鹿扑过去一样，它恶狠狠地撕下了它的一大块肉，猎犬哀嚎着和白眼狼扭打在一起，狼群远远地听到了猎犬凄惨的哀嚎声，觉得或许这是猎人的又一什么新招式。&lt;/p&gt;
&lt;p&gt;当猎人赶到这两团血肉模糊的动物旁时，猎犬已经被白眼狼咬中了脖颈，断了气——狼不论怎样还是比这个后辈厉害些的。&lt;/p&gt;
&lt;p&gt;猎人看到这团血色中若隐若现的白眼，气不打一处来，“那天没除了你这个恶种，今天就来祸害我，我非得教你死我眼前不可！”说罢抬枪便射。&lt;/p&gt;
&lt;p&gt;白眼狼身上中了一弹，它呜叫着松开猎犬，又扑到猎人身上，猎人在装弹的慌乱中用手臂去挡，它便用尽全身的气力在那上面咬上了一口。&lt;/p&gt;
&lt;p&gt;“畜牲，我可也是你的半个爹呐！”猎人就着传遍全身的剧痛大喊一声，另一只手摔下枪拔出腰间的砍刀，他怕砍中了自己的手臂，便用刀尖向白眼狼的肚上穿去。&lt;/p&gt;
&lt;p&gt;血淌了下来，黏在地上，又开了一朵在那天夜里白眼狼见过的红莲，但这一次，谁都帮不了它了。&lt;/p&gt;
&lt;p&gt;“这白眼狼，可害得我一番苦。”在白眼狼死后，它还久久没有松口，猎人只好把它的头骨也斩碎，这才松了手臂。&lt;/p&gt;
&lt;p&gt;那天夜里，猎人同时吃到了三种肉。&lt;/p&gt;
&lt;p&gt;当白狼得知猎人失去猎犬的喜讯时，招呼狼群连夜嗥叫以纪念白眼狼的功绩。&lt;/p&gt;
&lt;p&gt;在许久之后的狼群中，每头狼王都会提到白眼狼作为狼的反例，狼群在那时也都只会想起那头只会分享猎物而不参与狼群狩猎，最终还抛下狼群自己过好日子去的，一只眼珠是纯白色的，白眼狼。&lt;/p&gt;
</description>
        </item>
        <item>
        <title>18岁前的“我”们</title>
        <link>http://localhost:1313/p/18%E5%B2%81%E5%89%8D%E7%9A%84%E6%88%91%E4%BB%AC/</link>
        <pubDate>Sat, 12 Apr 2025 00:00:00 +0000</pubDate>
        
        <guid>http://localhost:1313/p/18%E5%B2%81%E5%89%8D%E7%9A%84%E6%88%91%E4%BB%AC/</guid>
        <description>&lt;h2 id=&#34;前言&#34;&gt;前言
&lt;/h2&gt;&lt;p&gt;你好，我不知道你是谁，但请找个地方坐下，或者躺着，help yourself，接下来的内容不会很短，虽然它仅仅有关于我活过的贫瘠的前17年。&lt;/p&gt;
&lt;p&gt;你可能会说我是标题党，不是18岁前吗？没错啊，18岁前的时间跨度不就是17年&lt;/p&gt;
&lt;p&gt;你可能又想，写自传是一个吃力不讨好的工作，写的好有什么用，写的不好那就更没必要写自传了，那问题来了，干嘛写它？我只是觉得，既然莎比可以写三个人的一天写上成千上万字，那我为什么不能写，我想写，便写了，与看的人又有什么关系呢，你说是不吼，看的人&lt;/p&gt;
&lt;p&gt;现在是2025年的4月12日，我在昨天晚上心血来潮地想写一篇长文配到我刚刚搭建好的个人博客上，于是，便有了以下的杂乱的回忆，你可能会怨恨我写的杂乱，又岂知道我的这17年其实就是杂乱的，我有时甚至会把梦掺到现实中，又有时会把现实当成梦&lt;/p&gt;
&lt;p&gt;这17年&lt;/p&gt;
&lt;p&gt;我们看看吧&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;学海无涯&#34;&gt;学海无涯
&lt;/h2&gt;&lt;h3 id=&#34;幼儿园&#34;&gt;幼儿园
&lt;/h3&gt;&lt;p&gt;2006年11月1日，哦，真是个不吉利的日子，那么多1，你怎么不双11出生呢，非得留个0当遗憾&amp;hellip;农历9月11日，更不吉利了，多好的911，某架飞机的碰撞箱与某两栋大楼的刚体重叠&lt;/p&gt;
&lt;p&gt;伤春悲秋，秋是用来悲的，哈，我的人生是用来悲的，此言不假&lt;/p&gt;
&lt;p&gt;我们直接略过许多，从幼儿园开始&lt;/p&gt;
&lt;p&gt;幼儿园里可以谈的，只有两个兴趣班&lt;/p&gt;
&lt;p&gt;一个是学心算和算盘的，我对那个地方最深的印象是我和几个要好的同学经常在上课时离开座位，排成一条龙悄悄摸上讲台，然后跟着老师在黑板上板书的运动轨迹左右摆，在老师快结束板书的时候又冲回座位上，是的，就是这样，我现在回忆起这个就跟梦一样，真的很逆天&lt;/p&gt;
&lt;p&gt;但就是这样一个学生后面还是得了“初级心算小能手”的奖状，并确实可以秒算很多个多位数的加减（有多多呢？差不多10个3或4位数算加减那样的程度），不过现在你叫我展示一下的话，我肯定展示不出来了，小学的时候就已经丢掉了（笑&lt;/p&gt;
&lt;p&gt;另一个兴趣班是学画画的，呃，更确切的讲应该是学上色的，我印象中没画过什么画，就是画了也没保存下来，在这里我经常展现出我乐善好施的天赋，将我本就不多的水彩笔分享给其他同学（不管是认识的还是不认识的）&lt;/p&gt;
&lt;p&gt;于是就经常有水彩笔找不到的情况，甚至乎在某次急匆匆的借笔中，某个同学还把我的水彩笔盒子摔裂了一块，当时我婆和我爸就告诫我说管好自己，不要借给别人东西&lt;/p&gt;
&lt;p&gt;但我还是会借，没办法，谁叫我这个人就是这样，只是借给别人的时候更小心谨慎了些，会在脑子里记下借笔的人的名字和借了哪个颜色的笔，或许我的速记能力就是从这里开始培养的吧（笑&lt;/p&gt;
&lt;p&gt;接下来我们把时间轴推到小学&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;小学&#34;&gt;小学
&lt;/h3&gt;&lt;p&gt;小学六年呐，那事可太多了，但大事却太少了&lt;/p&gt;
&lt;p&gt;关于我是哪个年级离开那栋临时教学楼（应该说是临时教室，因为它只是一个平房）的，我已经记不大清了，反正可以知道的是，从入学到那个年级，9班的教室一直都是一个远离正式教学楼的，附近没有厕所的，甚至周围长满了草，有同学说经常在周围看到蛇的，只有一层的平房&lt;/p&gt;
&lt;p&gt;而我，是9班这个老师带过的最差的一届班级的一员&lt;/p&gt;
&lt;p&gt;一年级，我们教室周围没有厕所，要上厕所只能去遥远的教学楼上（其实不遥远，但基于一年级学生的体质，当我跑到教学楼上完小的再跑回来时，上课铃就会恼人地吵起来，导致我没有时间去玩），所以，为了不浪费宝贵的课间时间到上厕所上，我决定，就地解决！（拍案&lt;/p&gt;
&lt;p&gt;是的，就是就地解决，当时的我可以说是既害臊又不害臊，若我想上小的，我会到教室楼房的后面那块经常有人说看到蛇的草地去解决，有的时候就会不碰巧地被一些去教学楼上厕所的男生女生看到&amp;hellip;但我stick to my position，这个解决方案在教室附近建起临时厕所前我一直用着&lt;/p&gt;
&lt;p&gt;后面得说起小学的两个重大转折点了，恕我的长期记忆力不是很好，我实在记不得这两个转折点哪个前哪个后了，所以我就随便挑一个先开讲&lt;/p&gt;
&lt;h4 id=&#34;校园结义&#34;&gt;校园结义
&lt;/h4&gt;&lt;p&gt;三年级，不记得上学期还是下学期，有三个莫名其妙认识的，莫名其妙关系很好的，相同点应该只有都戴红领巾穿校服的小学生，下课时他们经常聚在一起，玩其中一个人迭代了十来版的纸上游戏，“小兵大战”（其实游戏很多，有的时候会玩其他的，但这个是最经典的）&lt;/p&gt;
&lt;p&gt;他们成立了一个游戏组织玩这个游戏本，起初叫罗大屁集团，最终boss是罗小屁和罗中屁，后来我们的老大一拍脑子改国号为四维（其实不是国号，只不过是把自己的外号改了），我们就叫四维集团，对头是罗大、中、小屁（不过这倒是四年级或五年级的后话了）&lt;/p&gt;
&lt;p&gt;在一个阳光明媚的早晨（或许是大课间？），这三个都读过三国演义的小孩都拍了一下自己的脑袋，他们脑海中浮现桃园结义的大场面：那时正值桃花盛放之季，两个大汉和一个弱男子齐聚桃园煮酒，三人喊着“不求同年同月同日生，但求同年同月同日死”的豪言，决定从此同生死，共患难&lt;/p&gt;
&lt;p&gt;然后一切就都自然而然的发生了，三个被自己洗脑的小孩一下课便齐刷刷地跪在教室后门的外面，后面的事不需多讲，你大概也能脑补出一些场面，这件事过后，太史公便在棺材里曰：此谓“校园三结义”是也&lt;/p&gt;
&lt;p&gt;这三个小孩截止目前，一个在西北大学，一个在杭州电子科技大学，一个在华中科技大学，后话就待几年或几十年后再来写吧&lt;/p&gt;
&lt;h4 id=&#34;补课和暗恋&#34;&gt;补课和暗恋
&lt;/h4&gt;&lt;p&gt;不记得几岁，更不记得几年级，那时正是补课现象猖獗，补课机构收入堪比开矿的年代，我爸，或许也有我妈，决定把我丢去小星星补课机构，学啥？学英语。我不知道这样做的目的是什么，或许是老生常谈的赢在起跑线上，又或许只是让我少烦他们，抑或是我的两天的假期时间让他们眼红了（bushi），亦或是其他什么原因比如看其他孩子都去补了于是跟风让我也去补，反正祸根从此种下，补课的种种经历是我探及自己性格形成原因时逃不开的话题&lt;/p&gt;
&lt;p&gt;起初小学还是幼儿园学的小红帽白雪公主英文版，后面就学领跑，再到领跑提高班（说着很高大上，其实教材都不知道是哪来的，我甚至都觉得是补课老师聚在一起自研的）&lt;/p&gt;
&lt;p&gt;领跑提高班，我在的是一个挺压抑的班级，至少我这么觉得，当时老师似乎是要求写完书上的题才能在放学的时候走的，但有时我死活看不懂书上的单词，急得跺脚&lt;/p&gt;
&lt;p&gt;后来有一个小星星自己的大考，根据考试成绩分班，好的一批放一起，学新版新概念（就是青少版），差的一批放到一起，学老版新概念（那个封面上四个圈，看着就让人没有食欲的的版本）&lt;/p&gt;
&lt;p&gt;很不幸地，我因为某些原因没有考好（这些原因和知识关系不大，和性格关系大，就是我的一身反骨驱使我去觉得这张考试卷子有些题出的不准确，模棱两可，所以我决定按我所想的写而不是按考试题目来写，并寄希望于改卷老师能看到我的答案然后反思他的题可能出错了然后只给我分不给其他根据考试题目写的学生分，是的，当时我就是这么犟），离90差一两分（满分100），但只有90分以上的人才能分到好班，于是我理所应当地被淘汰到了差班（不过也没有差的离谱就是了，反正人均素质成绩是比我高中高的）&lt;/p&gt;
&lt;p&gt;然后我就学旧版新概念学了好几年，一直学到初二，直升班考试前，我学完了新概念一二两册&lt;/p&gt;
&lt;p&gt;上了初三，我就没有补课了，一直到高一我又回归补课机构补了一丁点，后来就没去过补课机构补课了，到了高二更是只到私人补课的地方补了&lt;/p&gt;
&lt;p&gt;“Stop！打住！你标题不是暗恋吗，你写的啥，这里有提到人吗，这不是补课吗，你干脆把小标题改成补课得了，死标题党，吃我一拳！”&lt;/p&gt;
&lt;p&gt;莫急，兄弟莫急，这行文里处处无她，在我眼里却写尽了她口牙&lt;/p&gt;
&lt;p&gt;或许是领跑提高班，或许是这之前的某个班，但我这里就写领跑提高班这个确定的转折点吧，我和她都在这个领跑提高班&lt;/p&gt;
&lt;p&gt;课程计划到一半，或者是临近期末，我注意到了她，在这之前我可是认真学习的好学生嗷&lt;/p&gt;
&lt;p&gt;我喜欢她&lt;/p&gt;
&lt;p&gt;我不懂喜欢是什么，我不懂男男女女，我不懂天若有情，我不懂人间沧桑，但我就是喜欢她，我不知道为什么喜欢她，不知道喜欢她的哪里，我只知道，我喜欢她&lt;/p&gt;
&lt;p&gt;但正是因为我不懂这些种种，我什么都不懂，我不知道怎么向她表示喜欢，我也不知道什么提升自己来吸引他人，我不会a上去，也不会发育加一波，我是沙币，于是接下来到来的就是&lt;/p&gt;
&lt;p&gt;无可救药的暗恋和异想天开的意淫&lt;/p&gt;
&lt;p&gt;后来者写这些就是容易站在上帝视角看这些蠢事，我不怪那时的喻轶，他这么做有他的理由，虽然他现在已经死了，那年的喻轶和一些喻轶死在了高考后的那个暑假，尸体由我亲自埋葬，这些都是后话&lt;/p&gt;
&lt;p&gt;我开始做一些痴心妄想者做的事，这些事我就不写了，男看男鄙夷，女看女恶心，我看我悲哀，她看&amp;hellip;还好她不会看的&lt;/p&gt;
&lt;p&gt;补课的时间是短暂的，我只能通过寄希望于和她在同一个班的时间多一点来满足我喜欢她的欲望，可惜天不遂人愿，我在分班大考中被分到了差班，而她被分到了好班，没错，就是那场我考差了的大考，后来想想&amp;hellip;算了还是不想吧，相信这是最好的安排&lt;/p&gt;
&lt;p&gt;然后我就疯了（不是那种疯嗷，这里只是非常夸张而已，我很确定我是一个冷静的人（笑））&lt;/p&gt;
&lt;p&gt;后来的新概念课其实我都是心不在焉地听的，但鉴于课太多了（想象一下，两本新概念，每篇课文都上两个小时，你看看有多少次课吧），再加上新概念课会要求每天听15分钟课文录音（这件事我坚持了2年，两年的每一天晚上睡觉前都会用我那个老年机放，就是拿这个当安眠药吃，效果极佳，大多数情况下都会放到下一天早上，因为有时没关就直接睡着了），就是再傻的人，上了这么多课，听了这么久录音，也会培养出人们常说的很难培养的“语感”，没错，我的英语语感就是这么来的，有部分原因是拜她所赐&lt;/p&gt;
&lt;p&gt;为什么我上这么多课？没有她在的课不是更难过吗，那我不应该从此以后再也不补课吗？哦，我不是这样的，我只是异想天开的认为好班可能会和我们一起上下课，然后或许我就有机会在上课路上或课间或下课路上看到她，没错，就是这么个事，我是沙币&lt;/p&gt;
&lt;p&gt;和她的事在小学就是这么点，有一些无关紧要的比如我们三兄弟满教学楼跑的时候我会看到她，比如有时放学后我们三兄弟玩很久后我回家路上看到她从琴行上完课出来，这些事里我和她都没什么大的交集，所以就不写了，要真说到交集，请看初三&lt;/p&gt;
&lt;p&gt;以上，是我的小学，和幼儿园并称我最轻松的两个时期&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;初中&#34;&gt;初中
&lt;/h3&gt;&lt;p&gt;我后悔上了青荷班&lt;/p&gt;
&lt;p&gt;青荷班是我们那的最好的高中办的，寄生在它的附属中学的一类班，它网罗附近所有小学成绩好的那批人，它每届招两个班，这两个班里每届都有清北生，所以，它的资格考试难度巨大，选拔机制也是尤其苛刻，笔试面试简直就是入职而不是入学，里面的人都是精英中的精英&lt;/p&gt;
&lt;p&gt;我们这届除外&lt;/p&gt;
&lt;p&gt;我们这届扩招了一倍，而且还有很多关系户涌进来，我是被扩招的一员&lt;/p&gt;
&lt;p&gt;可想而知，我到了一个不属于我的高度&lt;/p&gt;
&lt;p&gt;结果一定是痛苦的&lt;/p&gt;
&lt;p&gt;我确信&lt;/p&gt;
&lt;h4 id=&#34;青荷考前集训营&#34;&gt;青荷考前集训营
&lt;/h4&gt;&lt;p&gt;我想从小学备考青荷班讲起，因为要考青荷班，我的父母还决定让我报小星星的“青荷考前集训营”，在这里怎么说呢，我好像是一班的，然后我暗恋的她在二班，反正我们不在一个班，我知道她在二班还是因为这个集训营在结营时会组织团健一次，我才知道她也在&lt;/p&gt;
&lt;p&gt;再得说这个集训营&lt;/p&gt;
&lt;p&gt;语文老师要求班里的每个学生都上台做自我介绍，这似乎是我这辈子第一次当着二三十个人的面“演讲”，很可惜，我讲到一半就不知道怎么讲了，我的大脑在那时是completely blank，我“唉”了一声，然后下台了&lt;/p&gt;
&lt;p&gt;数学老师是个畜牲&lt;/p&gt;
&lt;p&gt;在小学时我对老师并不非常讨厌，但这个老师让我对“老师”这一职业的厌恶上升到了极点，从此我对“老师”有了一种不可磨灭的刻板印象，对，就是从个人上升到集体&lt;/p&gt;
&lt;p&gt;在某一次课上，某个同学和我说话，被这个畜牲发现了，于是他抄起旁边的凳子向同学砸去，这位同学还算有骨气，背起包转身就走了，我是没那个骨气的，也没有那么强大的反抗决心，这位畜牲便又严词警告我不要和这种人交好&lt;/p&gt;
&lt;p&gt;在同一节课，我做完了畜牲在课堂上布置的当堂作业，于是便看着草稿本走神，不知道为什么，畜牲看着我说“写完了没有”，我回我写完了，它便叫我拿着书上台来给它看，它拿着我的书，又看看自己的书，又看看我的书，把书摔在桌上，给了我一巴掌&lt;/p&gt;
&lt;p&gt;假如是现在的我，假如我带了刀，我非得叫他“流血五步”不可&lt;/p&gt;
&lt;h4 id=&#34;初一和晚自习&#34;&gt;初一和晚自习
&lt;/h4&gt;&lt;p&gt;最终我还是考上了青荷班，但像我前面说的，我不适合这里，我不适合青荷班，这里的学习强度太大了，而我当时还是一个只会玩游戏，和同学胡吹海吹的小屁孩，所以我的初中成绩自然而然地差，最高就是班上20+名，最低都吊车尾了&lt;/p&gt;
&lt;p&gt;初一有自愿晚自习（这个倒是真自愿，不是反讽），我一开始打算的是上两节晚自习向老师证明我爱学习学习使我快乐之后就不去的，但是捏，晚自习有一个点名环节，你猜猜点到了谁，诶，我暗恋的那个，从此我就决定这晚自习有几次我上几次，为了什么？为了向家长老师还有她证明我很上进（不过他们肯定是不会在意我上不上进的）&lt;/p&gt;
&lt;p&gt;你可能会觉得，我上晚自习？！那我的学习是不是就会好起来了，就应该名列前茅，然后引起她的注意，然后两手抓直接走上小说男主的路？&lt;/p&gt;
&lt;p&gt;哦，bro，那是我的幻想罢了，晚自习我常常写不完作业，不是因为时间不够，相反，比我成绩差的人都能写完作业并酣畅淋漓地刷题直到颅内高潮，但我不一样，嘿，我tm在设计游戏本和画火柴人漫画，要我说喻轶这b崽子是真的不吃几堑就不会想上进的（后来的事也确实让我吃尽了苦头，了了几百几千字是道不尽其中的心酸的，我也只能在这里调侃了）&lt;/p&gt;
&lt;p&gt;那时的晚自习我经常和一个青荷考前集训营的一个当时素不相识的同学坐在一起，当时我们常常聊游戏，他聊他玩的游戏，我聊我玩的游戏，然后他玩我聊的游戏，我玩他聊的游戏，两个人就这么交好了，初中的时候我只有一次月考比他高3分还是几分（当时因为这次考试，我调侃了他少说一个月，所以我记得这么清），其余情况下他都是班上名列前茅的存在，截止目前，他在西北农林科技大学，这是后话，按下不表&lt;/p&gt;
&lt;p&gt;我可能只能用浑浑噩噩来形容我初一初二的状态，因为我确实没学什么东西，也和喜欢和几个同学小打小闹，就和&amp;hellip;小混混一样？差不多吧，想不到你喻这个老实人也有当混混的时候吧（手动滑稽&lt;/p&gt;
&lt;p&gt;不过现在往回看的话，初一似乎我也受过一段时间的校园霸凌？这方面我记不太清了&lt;/p&gt;
&lt;h4 id=&#34;共学党&#34;&gt;共学党
&lt;/h4&gt;&lt;p&gt;这无疑是我初中的一个重大转折点了，说起来也确实奇怪，这个重大转折点的持续时间是真的长&lt;/p&gt;
&lt;p&gt;共学党是一个组织，一个以学生群众为主体的共学主义组织，党章是我起草的，但是现在应该找不到了，它的前身是拜Kealthy会，一个以教师Kealthy为核心的亲教师派，&lt;/p&gt;
&lt;p&gt;你可能会说，叽里呱啦什么乱七八糟的，哎，你只需要知道有这两个组织就行了，剩下的我来补充&lt;/p&gt;
&lt;p&gt;在初二，我们6班遇上了一个s体育老师，在体育课上他要求我们疯狂跑圈（不过他对跑圈的人还是睁一只眼闭一只眼的，就相当于走也行）且没有自由活动时间，这时就有一个英语老师站了出来，她要抢走我们的体育课，这要放在其他正常点的班级，肯定是一件怨声载道的事，但我们摊上了这样一个体育老师，对比之下，大家纷纷拥护起这位英语老师，她英文名是Kealthy，于是便有三个学生在一节没有被Kealthy解放的体育课上，众目睽睽之下，拜天拜地，成立组织，史称“拜Kealthy会”，其中一个人是我&lt;/p&gt;
&lt;p&gt;但是很不巧，在某一次英语早读，由于有一个做英语手抄报的作业在那时要交成果，场面一度混乱不堪（可以说是一片混沌了），Kealthy一怒之下责令全班同学交2000字检讨&lt;/p&gt;
&lt;p&gt;这在细想之下挺合理对吧，只不过字数有点多而已，毕竟是同学有错在先，但是但是，有这么一个群体，他们要在早上早读的时候带扫把下楼清扫班级包干区，当他们下楼的时候，教室一片寂静，他们上楼的时候，教室仍然一片寂静，多了我们敬爱的Kealthy在讲台上怒目圆睁&lt;/p&gt;
&lt;p&gt;我是这些扫地的群体其中微不足道的一分子，当我的同桌告诉我，因为我在早读的时候很吵，所以我要在明天上交2000字检讨时，我直接变沙币了&lt;/p&gt;
&lt;p&gt;后面Kealthy针对此事进行了公开道歉，但还是很可惜，拜Kealthy会就此覆灭了，我们不会再相信一个背叛过人民群众的领导&lt;/p&gt;
&lt;p&gt;于是共学党诞生了，它生根在拜Kealthy会的尸体上，组织成员还是这三个人，只不过他们不会再以老师为崇拜对象了，而是以学生群众&lt;/p&gt;
&lt;p&gt;这个组织后面还经历过一次政变，创始人之一被踢出了组织，后面又引进了一些新鲜血液，这些人大多并没有贯彻共学主义，层层筛选下来只留下来一个，所以现在的共学党依然只有三个人，或许他们在离开校园之后，共学党就不复存在了吧，但我相信，共学主义仍然会变着名字流传在学生中的，学生成为学校的中心，只是时间问题&amp;hellip;吗？&lt;/p&gt;
&lt;h4 id=&#34;初三&#34;&gt;初三
&lt;/h4&gt;&lt;p&gt;初二期末时有一个直升班考试，通过这个考试的人可以直接被我们当地最好的中学录取，他们中考也只是走走形式，我去考了，没考上，毕竟我初中就学的那样子，能考上的话，直升班的含金量就太低了&lt;/p&gt;
&lt;p&gt;我们青荷班考了将近一个班走，往常可没有这种情况（毕竟我们扩招了一倍），那咋办？有的班人满为患，有的班只剩十来二十个人&lt;/p&gt;
&lt;p&gt;那就并班&lt;/p&gt;
&lt;p&gt;我被分到了七班，青荷班最好的班，这可能是因为我初二期末考试物理得了满分，说到这个考试我又得提起我那个讨人厌的初二物理老师（这里是插叙，我写啥就是啥）&lt;/p&gt;
&lt;p&gt;他是纯粹的舔狗，据初中同学透露，他能记起班上每个女生的名字，但他又经常报错班上男生的名字，不管物理成绩好不好&lt;/p&gt;
&lt;p&gt;他曾经拿着我的物理“实验班”（一本习题册，挺难的）质问我是不是抄答案的，言外之意就是以我这种人的成绩和学习力是不可能写得了这么难的题目的，更别说是全对，我怎么回答的呢，我在期末考试考了个物理满分，当时他的脸色可不好形容&lt;/p&gt;
&lt;p&gt;好了，说回七班，由于我相当于插班生，第一件难事就是选位子，我尽可能选了一个旁边没有女生且地理位置偏远的位置&lt;/p&gt;
&lt;p&gt;但很可惜，老师后面还是把我调到了一个同桌全是女生，纬度靠近讲台的位置&lt;/p&gt;
&lt;p&gt;很不巧，我的左手同桌就是她&lt;/p&gt;
&lt;p&gt;没错，就是她&lt;/p&gt;
&lt;p&gt;我想，我的整个初三都可以围绕她来写&lt;/p&gt;
&lt;p&gt;我们先说位置吧，七班的位置分为三组，每组之间用走道隔开，每组的列分别是3，4，3，我们换位置的机制是每两周所有人的位置向靠门方向移动三列，这就导致有的时候我会只有一个同桌，那样的日子是真的&amp;hellip;我想找人聊天，我只有一个同桌，那我找她聊天就是世界上再合理不过的事了&lt;/p&gt;
&lt;p&gt;一个人的情绪如果被别人支配的话，那这个人就没有了灵魂，那时的我，呵&amp;hellip;挺好的&lt;/p&gt;
&lt;p&gt;但我后来又从共学党的情报网中知道，在初一初二有人追她，现在这个人在直升班，你可能会想，那我该发奋图强了吧，但很可惜，不要希望初中的我做出任何努力的决定，那时我就是上课假借听课而实际上是看她上课睡觉，下课又和她聊天，每天晚上写作业到深夜则是为了明天早上拿作业给她抄&lt;/p&gt;
&lt;p&gt;期间那个追她的直升班的人曾来过一次，还给她带了奶茶，据一同前来的女同学说是表示爱意的那种奶茶（我对奶茶一窍不通啊，要是我说错了没有这种的话不要拿这个喷我），这位腼腆的男生把奶茶放到她桌上之后还一直在外面偷看她，结果是一直到他离开，她都没有嘬一口奶茶&lt;/p&gt;
&lt;p&gt;然后，在他离开后，她转向我，问我要不要喝这个奶茶&lt;/p&gt;
&lt;p&gt;当时我以为喝奶茶会拉肚子为由拒绝了（别笑说是什么鬼理由，我喝奶茶真的会拉肚子（笑，但是哭））&lt;/p&gt;
&lt;p&gt;对她，我，我不知道该说些什么，或许你会问我，现在还喜欢她吗？我大概只会苦笑两声，然后告诉你以后不要再提她了&lt;/p&gt;
&lt;p&gt;以上，是我的初中&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;高中&#34;&gt;高中
&lt;/h3&gt;&lt;p&gt;“熊咆龙吟殷岩泉，栗深林兮惊层巅”，“云青青兮欲雨，水澹澹兮生烟”，“裂缺霹雳，丘峦崩摧，洞天石扉，訇然中开”&lt;/p&gt;
&lt;p&gt;在高三时，我曾想过把我的高中生活写成一本书，书名都想好了，叫做《群山回响：刀俎鱼肉列传》，但最终还是因为高考的缘故没有动笔，但假使让我动笔，上面的《梦游天姥吟留别》这几句会是开篇词，这三篇或多或少的对应着我的高中三年，一个双引号就是一年&lt;/p&gt;
&lt;p&gt;我本想直接从高一开始动笔，但是我还是想补上一下中考的位置，莫急，很少，我不想放在初中后面，就只好放在这里，见谅&lt;/p&gt;
&lt;h4 id=&#34;中考&#34;&gt;中考
&lt;/h4&gt;&lt;p&gt;在中考之前，我们经历了两次模拟考，一次是全市对比，一次是本校对比，第一次次我没有上到我们那最好的高中的线，第二次上了&lt;/p&gt;
&lt;p&gt;我们那的高中是这样的，只有三个公立学校给你选，一中，二中，三中，一中最好，有清北92双一流，二中垃圾最吊的是211，三中直接毕业打螺丝&lt;/p&gt;
&lt;p&gt;所以假如我中考出现什么失误的话，我就只有两条路可走（别跟我谈什么旷野轨道，你滚去辍学，我不去），一条是上二中（稳上二中的底气我倒是有的），另一条是去私立高中（可能出生率加死亡率大于一本率的那种学校）&lt;/p&gt;
&lt;p&gt;我们中考的作文题目和一只鸡有关，好像是一只鸡喜欢在夜里叫，于是家里人便把这只鸡卖了，好像是这样的，我不想查&lt;/p&gt;
&lt;p&gt;重点是你猜猜我写了什么作文，嘿，我这b崽子写了篇小说上去，你说，我说，什么罐头我说，what can I say啊？！&lt;/p&gt;
&lt;p&gt;我理所应当地落榜了&lt;/p&gt;
&lt;p&gt;我想自杀&lt;/p&gt;
&lt;p&gt;我决定去一所出生率加死亡率大于一本率的私立高中&lt;/p&gt;
&lt;h4 id=&#34;熊咆龙吟殷岩泉栗深林兮惊层巅&#34;&gt;熊咆龙吟殷岩泉，栗深林兮惊层巅
&lt;/h4&gt;&lt;p&gt;我是以全校第二还是全校第三的成绩进来的，学费免了很多，但最让我欣慰的是竟然还有和我一样不长眼的学生会来这个学校&lt;/p&gt;
&lt;p&gt;高一时我们的教师阵容非常豪华，我们一一说&lt;/p&gt;
&lt;p&gt;语文老师是省语文组的，具体是怎么个事我也不清楚，反正老谋深算&lt;/p&gt;
&lt;p&gt;数学老师是北师大硕士高材生，学历是我们教师阵容最高的，资历是最浅的，这个是本事最低的，就不细嗦了&lt;/p&gt;
&lt;p&gt;英语老师是几年前高考文科状元的英语老师&lt;/p&gt;
&lt;p&gt;物理老师英语老师老公，地位相同&lt;/p&gt;
&lt;p&gt;化学老师是一中退休老师，资历最老，这个老师我最讨厌&lt;/p&gt;
&lt;p&gt;生物老师我没怎么关注，因为我一开始是想学地理的&lt;/p&gt;
&lt;p&gt;政治老师是一个呃，形容不了的人，新生代好吧，新生代，没资历&lt;/p&gt;
&lt;p&gt;历史老师是一个富二代，体验生活来的&lt;/p&gt;
&lt;p&gt;地理老师是理科男神，曾在数学省赛因为看别人打篮球迟到半小时并提前半小时交卷继续看别人打篮球的情况下斩获数学省二，物理省一，我不知道为什么他要教地理，他还有自己的一套思想，有自己写的书，我想选地理的原因的大头就在他身上&lt;/p&gt;
&lt;p&gt;为什么这些这么吊的老师会来我们这个出生率加死亡率大于一本率的地方？我们的班主任物理老师告诉我们，以前他教的都是些极好的生源，体现不出他的实力，于是他必须要来这样的一个垃圾学校教出几个92来证明自己有把朽木雕出滕王阁的实力，他说我们会是他教的最后一届，把朽木雕成滕王阁是他的理想，于是他带着一众顶尖教师来了&lt;/p&gt;
&lt;p&gt;这个阵容很快就土崩瓦解了，首先是语文老师被挖走了，然后是这个物理老师带着一众他带来的顶尖教师都走了，他们去了开价更高的学校&lt;/p&gt;
&lt;p&gt;哈，这就是他的理想&lt;/p&gt;
&lt;p&gt;我在高一的时候成绩只有一次崭露头角，那次是高一上学期第三次月考，我考了数学校三，英语校一，物理校一，化学校一，地理校一，并在政治落后校二40分的情况下总分领先校二40分，在那时我突然明白，原来我也可以是主角，过去我当了那么多年的配角，当了那么多年的吊车尾，我也可以是第一，我配得上第一，我以后都要当第一&lt;/p&gt;
&lt;p&gt;此谓“熊咆龙吟殷岩泉，栗深林兮惊层巅”&lt;/p&gt;
&lt;p&gt;这是高一唯一的一次高光，后面我的成绩一度陷入长时间的寂静，那是在厚积薄发（不，纯粹是因为我的政治历史太烂了，其他科不爆发的话实在拉不起总分，但总分偏偏是按九科算的，你说我拿什么竞争）&lt;/p&gt;
&lt;p&gt;高一结束之后，那些好老师就走了，剩下了一地的鸡毛&lt;/p&gt;
&lt;h5 id=&#34;补课的终结&#34;&gt;补课的终结
&lt;/h5&gt;&lt;p&gt;在这个不适宜的地方我还想补充一下关于我的补课生涯&lt;/p&gt;
&lt;p&gt;我曾说在高中我也补过一段时间的课，但后面就只补私人了&lt;/p&gt;
&lt;p&gt;这里补充一点，我补私人也没补多久，在高三前就停掉了，具体是什么时候我记不太清了&lt;/p&gt;
&lt;p&gt;高中一开始我选择补化学，我中考化学是拖后腿的，因为化学在初三才学，而初三上课我又去看她去了，导致我初三基本没学化学，我得拿着我稀烂的基础去碰高中化学的硬茬子&lt;/p&gt;
&lt;p&gt;好在我做到了，做的很好，在跟着他学习一段时间后，我成了那个补课班上的化学第一，连那些一中的学子也奈何我不得，我觉得这个老师算是我遇到过的少有的好老师了，讲课是我见过的化学老师中的最好的，同时人也好，反正那那都好&lt;/p&gt;
&lt;p&gt;他本来在黑板上板书过他的联系方式的，但我没有记下来，至今我仍然觉得遗憾，他曾经看着我的卷子对我说，“你高中的化学成绩不会比重点中学的学生差”，从此以后我便发誓一定好好学化学&lt;/p&gt;
&lt;p&gt;在此和某位畜牲数学老师做对比&lt;/p&gt;
&lt;p&gt;但同一个补课机构，同样的学科，后来位尊敬的老师走了，换了一个差老师&lt;/p&gt;
&lt;p&gt;那时我既补了物理又补了化学，我从化学讲起吧&lt;/p&gt;
&lt;p&gt;化学老师是一个差学校的老师，她经常在上课上到半中央不知道自己教案上的题目怎么写，然后就由我们班上一位一中的同学来接题目茬，有时这位一中学子也不会，我就发表自己的看法，哪怕是对的，她也不予理会&lt;/p&gt;
&lt;p&gt;物理老师同理，这位一中同学也和我一起补物理，物理老师也独宠他一人，即使这位学子在上课时玩手机，他也在这位学子解出一道题后向全班宣布要想这位同学学习&lt;/p&gt;
&lt;p&gt;结课的时候要考试，老师会把学生成绩放到家长群里，还会根据学生的课堂表现写评语&lt;/p&gt;
&lt;p&gt;两门考试我都是第一，这位一中学子第二&lt;/p&gt;
&lt;p&gt;他的评语比我长&lt;/p&gt;
&lt;p&gt;我没有细看我的评语，我觉得恶心&lt;/p&gt;
&lt;p&gt;我决定再也不到这个补课机构补课了&lt;/p&gt;
&lt;p&gt;说到我私人的补课就得谈到我另一个喜欢的人了，在下文中会写，但与补课关系不大，毕竟老师挺好的，没有什么槽点，所以也写不了多少&lt;/p&gt;
&lt;h4 id=&#34;云青青兮欲雨水澹澹兮生烟&#34;&gt;云青青兮欲雨，水澹澹兮生烟
&lt;/h4&gt;&lt;p&gt;高二考试只看选的六科，我本想选物化地，但可惜师资不行，我被迫选了物化生，生物是我的弱项，学着实在难受&lt;/p&gt;
&lt;p&gt;我走上了登神长阶&lt;/p&gt;
&lt;p&gt;至少在我那个学校是这样的&lt;/p&gt;
&lt;p&gt;“起初人们以为这只是平平无奇的，姓喻的人当了一次月考全校第一的事，但后来他次次都是第一，事情就开始变得不对劲起来”&lt;/p&gt;
&lt;p&gt;不严格意义上来说，我当了两年的全校第一&lt;/p&gt;
&lt;p&gt;此谓“云青青兮欲雨，水澹澹兮生烟”&lt;/p&gt;
&lt;p&gt;这是我高考的基石&lt;/p&gt;
&lt;p&gt;但我还是想说另外一件事&lt;/p&gt;
&lt;h5 id=&#34;我和她和她&#34;&gt;我和她和她
&lt;/h5&gt;&lt;p&gt;没错，是两个她，我没打错你也没看错，我会在这里写完我可悲可笑的恋爱历程&lt;/p&gt;
&lt;p&gt;在高二时，我鼓起勇气通过某些关系网拿到了她的qq号并加上了&lt;/p&gt;
&lt;p&gt;我向她倾诉了我高中经历的种种，当时我们的关系还是挺好的，就相当于好朋友吧（唉，朋友，唉），在加上她qq后我每周回家（我们高中学校是寄宿制的）都会和她聊天，对，每周，我就是这么能坚持，特别是高二还有一段疫情，那时就是天天我都聊，当然，我不知道她想不想聊&amp;hellip;.&lt;/p&gt;
&lt;p&gt;那时我天真地以为聊久了就会日久生情，我还是太幼稚了&lt;/p&gt;
&lt;p&gt;然后我就在一次月考向她炫耀成绩后侧面表白了，具体情况是她问我为什么成绩好，我说是因为她（别看我这里说的这么少，但我可是写了好几页qq聊天记录来阐述并论证这个观点（笑，然后哭）），然后两个人就balabala的&lt;/p&gt;
&lt;p&gt;最后结果就是“我不想谈恋爱”，“当朋友不好吗”&lt;/p&gt;
&lt;p&gt;完美的复刻！复刻谁，复刻什么事我不说，自己体会&lt;/p&gt;
&lt;p&gt;后来我们两个的关系在这之后渐渐冷下来&lt;/p&gt;
&lt;p&gt;在高二时我想补上她在我心里的空缺，于是我便假借“一见钟情（见色起意）”为由想和我的一位高中同学谈（其实是因为在她离开我心里心里之后，我又在另一个她身上看到了她的影子）&lt;/p&gt;
&lt;p&gt;我也在刚表明来意之后就和她谈了她的事（向第二个她说第一个她）&lt;/p&gt;
&lt;p&gt;但如我前面所言，我们这个高中的人成绩都太差劲了，所以假如要长远打算我就得想办法提高她的成绩，那咋办？老师都是烂老师，咋办？我自己教&lt;/p&gt;
&lt;p&gt;我自己教或许耗了我很多时间，但有一说一对我还是有点帮助的，这和在编程时放一只猫在旁边向它解释代码有异曲同工之妙，这就是费曼学习法的简化版&lt;/p&gt;
&lt;p&gt;但我还是觉得自己被利用了（或者说被自己戏弄了），我谈恋爱是为了学习，我学习是为了谈恋爱？什么无限递归函数？！&lt;/p&gt;
&lt;p&gt;然后我又干了一件蠢事，我觉得没有人理解自己，于是我向她倾诉，呃，是第一个她（向第一个她说第二个她）&lt;/p&gt;
&lt;p&gt;在和她分手时（其实根本没有明确地谈，也不能说分手），我又和她说了她的事（再次向第一个她说第二个她）&lt;/p&gt;
&lt;p&gt;哈，是不是很沙币&lt;/p&gt;
&lt;p&gt;可悲又可笑&lt;/p&gt;
&lt;p&gt;后来啊，第一个她考去了南昌大学，她在高考后把我的qq删了，我曾试过加回去，没有成功，第二个她我不知道去了哪，反正不是一本，现在还有qq，但是这辈子应该不会再联系了&lt;/p&gt;
&lt;h4 id=&#34;裂缺霹雳丘峦崩摧洞天石扉訇然中开&#34;&gt;裂缺霹雳，丘峦崩摧，洞天石扉，訇然中开
&lt;/h4&gt;&lt;p&gt;没有补课来消耗我的时间&lt;/p&gt;
&lt;p&gt;没有恋爱来消耗我的精力&lt;/p&gt;
&lt;p&gt;我有着差劲的师资，且我是两年的全校第一，所以我有着上课自习的自由，且我必须上课自习（因为上课学不到什么知识，上45分钟学到的不如我自学10分钟学到的，更奇葩的是我自学10分钟后就可以在下课时用5分钟给上课听了45分钟还不懂的同学完全讲解这个知识点）&lt;/p&gt;
&lt;p&gt;挡在我面前的是两座大山，高考，自己&lt;/p&gt;
&lt;p&gt;我合理怀疑当时的我有抑郁症或自闭症的前兆，我相信大部分临近高考的高中生都多少有一点，我应该也不会是最强烈的那一批&lt;/p&gt;
&lt;p&gt;反正就是我想死&lt;/p&gt;
&lt;p&gt;没有人可以在学习上帮到我，高考只有我自己独自面对&lt;/p&gt;
&lt;p&gt;于是我没日没夜地刷题，有什么刷什么，一天写100面辅导书（53还是必刷题，或者是二者的混合），高三的我做到过，不止一次，我的成绩只能通过刷题+费曼学习法+给同学讲题来提升&lt;/p&gt;
&lt;p&gt;在这里我想附上一张图来让你直观地感受一下&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://localhost:1313/p/18%E5%B2%81%E5%89%8D%E7%9A%84%E6%88%91%E4%BB%AC/18%E5%B2%81%E5%89%8D%E7%9A%84%E2%80%9C%E6%88%91%E2%80%9D%E4%BB%AC1.jpg&#34;
	width=&#34;521&#34;
	height=&#34;10000&#34;
	srcset=&#34;http://localhost:1313/p/18%E5%B2%81%E5%89%8D%E7%9A%84%E6%88%91%E4%BB%AC/18%E5%B2%81%E5%89%8D%E7%9A%84%E2%80%9C%E6%88%91%E2%80%9D%E4%BB%AC1_hu_65a9cd43d0824364.jpg 480w, http://localhost:1313/p/18%E5%B2%81%E5%89%8D%E7%9A%84%E6%88%91%E4%BB%AC/18%E5%B2%81%E5%89%8D%E7%9A%84%E2%80%9C%E6%88%91%E2%80%9D%E4%BB%AC1_hu_cc7a4fded1db2283.jpg 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;18岁前的“我”们1&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;5&#34;
		data-flex-basis=&#34;12px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;你可能会说，原来就写了这么点吗，还抄题写，效率真低&lt;/p&gt;
&lt;p&gt;不，这是我的错题本和我的教案，每一道题的解法我都有注解，这还是我高三上学期中间开始写的，图也只是一部分（可能你想问为什么这么糊，原图我找不到了，这是我qq动态里的，已经被压缩分辨率了）&lt;/p&gt;
&lt;p&gt;当时我依靠着余华的《活着》来活着，我想，福贵都那么惨了，还活着呢，我要是因为一个高考就自杀了，那我太废物了（虽然我就是一个废物）&lt;/p&gt;
&lt;p&gt;我本想着周末可以回家玩游戏来降压，可是我那父母以高考临近为由吵吵着让我不要玩，我顶着压力玩他们就更吵吵了，并一致认为我这辈子就只能上大专然后毕业去打螺丝了，所以要我周末也要“好！好！学！习！”，那可好了，我的san值越来越低，san值不够刷题效率就会低，刷题效率低就会焦虑，焦虑找不到方法缓解就想到游戏里杀两个人，但我又不能玩游戏，结果就是死循环，有什么办法呢？让我摊上这样的父母&amp;hellip;&lt;/p&gt;
&lt;p&gt;我的高三结束了，或许高考再延后一点的话我真的会自杀&lt;/p&gt;
&lt;p&gt;高考那几天你问我什么心情，我肯定会答没有心情，这是实话，我实在无法描述高考那几天我的心路历程，感觉就是平平缓缓的，毫无波澜&lt;/p&gt;
&lt;p&gt;高考后该配手机电脑了，我的父母一致认为我应该在高考成绩出来后根据成绩来配，因为他们根据我在家的表现（天天玩电脑，说了也死不悔改）一致认为我只配上个大专，所以我理所应当地只配拿几年前就淘汰的笔记本和老年机去用，对，我只配这些，手机和电脑？我这b也配？&lt;/p&gt;
&lt;p&gt;好在我做到了，写到这里我感觉&amp;hellip;说不出来的感觉，算了不说感觉了&lt;/p&gt;
&lt;p&gt;高考成绩出来了，江西606，江西考生大约550,000人，我是第8,944名，我不是顶尖人才，但也是我自己的救赎吧，是为“裂缺霹雳，丘峦崩摧，洞天石扉，訇然中开”&lt;/p&gt;
&lt;p&gt;211南昌大学专业随便选，还超出了二三十分&lt;/p&gt;
&lt;p&gt;但我不去211&lt;/p&gt;
&lt;p&gt;一部分是因为父母亲戚那些冷嘲热讽，另一部分是我觉得这个政策211没出路&lt;/p&gt;
&lt;p&gt;我去了杭电，计算机专业，虽然不是计科，但绝对比昌大好&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;大学&#34;&gt;大学
&lt;/h3&gt;&lt;p&gt;由于只能写18岁之前的，所以这里是不能直接写到现在的&lt;/p&gt;
&lt;p&gt;我的专业与游戏基本无关，但是由于我从小就爱玩游戏，我爸又是信息处的，所以有时我爸周末加班，或者暑假寒假当班，我就可以跟着去玩一天的游戏，对，不夸张，就是一天，10到12小时的游戏时间，中间吃泡面休息一下就继续玩，我可以说那段时间4399主页上的游戏没有我没玩过的（女生游戏除外），就连类传奇游戏我都试过，真的是一刀爆一地的装备（bushi&lt;/p&gt;
&lt;p&gt;再加上愤世嫉俗，这个世界不可能成为乌托邦了，至少在我活着的时候不会，那我只好自己创世，游戏便是这样的，我是游戏开发者，那我便是创世神，这是任何事情都不能带给我的感觉，我要在游戏中创立一个乌托邦&lt;/p&gt;
&lt;p&gt;上大学前我被拉进了杭电一个学生组织，这个组织的关系网里能人异士挺多的，我就趁机加到了一位游戏技术策划的qq，自此我就走上了游戏开发这条不归路，先是ue蓝图，再是unity，再到现在到godot，专业知识也从数字媒体，串到软件工程，再到计算机图形学，我基本把能涉猎的东西涉猎了个遍&lt;/p&gt;
&lt;p&gt;但我依旧在黑夜下龋龋独行着，还是没有人能帮我，还是一切只能靠自己，这后面的事，或者几年，或者几十年，到那时候再说吧&amp;hellip;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;以上，是我根据教育时间线理出来的17年&lt;/p&gt;
&lt;h2 id=&#34;人云亦云&#34;&gt;人云亦云
&lt;/h2&gt;&lt;p&gt;在这里我会挑出一些对我仍然有深远影响的人，只有一点，你若想看完，也不会占用很长的时间&lt;/p&gt;
&lt;h3 id=&#34;作家们&#34;&gt;作家们
&lt;/h3&gt;&lt;p&gt;本来吧，这个标题是想写“偶像”的，但这容易和某些男不男女不女的类人挂上钩（他们把这个词玷污了），所以我还是改成“作家们”好了，至少这样没有歧义&lt;/p&gt;
&lt;p&gt;我崇拜的作家从上往下排下来前三是鲁迅，余华，余秋雨，后面的那些我就不提了，要提的话能再写一篇文出来&lt;/p&gt;
&lt;p&gt;鲁迅的文章嘛，在知乎上有个很好的比喻，我找不到了，我改了改就是：好比一根骨髓健壮的硬骨头，要是熬久了能吸到极少的极腥的而又极鲜的骨髓，但若没有耐心不想熬它，也可以拿着这根骨头到处敲人，从迅哥儿身上学到的反而不是那么多血淋淋的社会现象，是他那样的白话文刚出时的写作风格(bushi&lt;/p&gt;
&lt;p&gt;余华的文章对我就好比一剂苦药，也不算药，就是苦，苦到我在喝完它后能耐受住这✓十的世界，我前文也说了，高考那段时间我就是靠着余华的《活着》续命，你要问我从里面学到了什么？我只能说我知道我还不配死&lt;/p&gt;
&lt;p&gt;余秋雨嘛，本来在初中我们语文老师就给我们打印过《文化苦旅》的《风雨天一阁》，当时的我，不喜欢看散文，散文又没营养（比如看议论文可以学“真理”），又没有引人入胜的剧情（小说也没营养，但它能拿来消磨时间），但我在看了这篇文章之后想法就改变了，因为这篇散文兼具上面的两个优点，又有营养，又引人入胜（简直和迅哥儿的小说一样），颠覆了我对散文的刻板印象，虽然在他之后我也没看过很多散文，但至少我也从他的文章中看到了某些世界级的文化&lt;/p&gt;
&lt;p&gt;（别看我越喜欢的写的越少，他们都是顶级作家我怎么敢评的啊喂）&lt;/p&gt;
&lt;h3 id=&#34;外公&#34;&gt;外公
&lt;/h3&gt;&lt;p&gt;我忘记了他的忌日是哪天了，他死于新冠引起的并发症&lt;/p&gt;
&lt;p&gt;我不知道该如何描述他，不知道该如何形容他&lt;/p&gt;
&lt;p&gt;他没能看到我上大学的那天&lt;/p&gt;
&lt;p&gt;他走前，我不谙世事，他走后，我茕茕孑立&lt;/p&gt;
&lt;p&gt;遗憾&lt;/p&gt;
&lt;h3 id=&#34;家庭&#34;&gt;家庭
&lt;/h3&gt;&lt;p&gt;说到底，我讨厌我父母&lt;/p&gt;
&lt;p&gt;我知道这在道德里是不对的，虽然我鄙夷“道德准则”这个东西，但我依旧认同这一点，所以我还是会尽所谓的“孝道”，尽量不去表现我对他们的讨厌并且会尽力给他们一个好的晚年&lt;/p&gt;
&lt;p&gt;（也就是因为他们，我才觉得钱很重要，假如他们都不在的话，我就不会在乎我有多少钱，毕竟我对自己的死一直都是很宽容的）&lt;/p&gt;
&lt;p&gt;我的父母总喜欢搬弄是非，喜欢用一堆老到不能再老的理论和现实来说现在这个日新月异的社会，还喜欢否认一些板上钉钉的事实（比如高中学到的知识下辈子都用不上），你可能会说“不听老人言，吃亏在眼前”，但我初中就是听他们的，结果呢，我高中则是自己对自己的再教育，结果又是怎么样，显而易见&lt;/p&gt;
&lt;p&gt;或许是有我哥这个中山大学高材生的存在，他们在小学初中一直对我的成绩寄予厚望（初中青荷班更甚），在拿我和其他高材生对比的同时一边鼓励我一边贬低我（毕竟我初中成绩就是比不上那些高材生），然后在看到我去了一所出生率加死亡率大于一本率的高中后就对我冷嘲热讽（比如这辈子能上大学就不错了什么的），我及其厌恶这一点，及其厌恶&lt;/p&gt;
&lt;p&gt;搞歧视的人应该和畜牲坐一桌&lt;/p&gt;
&lt;p&gt;甚至还有，我17岁的生日&lt;/p&gt;
&lt;p&gt;任何人都可以预见的，我的17岁生日大概率是我在家里过的最后一个生日&lt;/p&gt;
&lt;p&gt;但很可惜，这是我前17年过过的最敷衍的生日，导致我18岁干脆就没有过生日，确定了一下游戏实名认证就没有什么特殊活动了，那时我很沮丧，或许以后每年我的生日都会是我的沮丧日&lt;/p&gt;
&lt;p&gt;有一个这样的原生家庭在我主观看来是可悲的（或许你会想说这已经是正常范畴了好吧，人要知足什么的，但我就是，不喜欢这样的家庭，他们经常拿我和其他高材生比，但这些高材生显然有一个比我更好的家庭，但他们就是把我哥这个偶然事件当成理所应当，或许他们还认为他们的理论能把任何人都培养成高材生，可笑），所以当我知道我的某个高中室友有一个更惨的原生家庭时，我尽量包容他的任何缺点，虽然我后面为了不影响我的学习还是换寝了（因为和他相处还是太消耗我的精神了）&lt;/p&gt;
&lt;h3 id=&#34;老师&#34;&gt;老师
&lt;/h3&gt;&lt;p&gt;我给一个概括的印象&lt;/p&gt;
&lt;p&gt;尽管我经常教别人，这也算是某种意义上的“赤脚”老师，但我排斥老师这个群体&lt;/p&gt;
&lt;p&gt;任何我没深入接触过的老师我都会直接把他们视为敌人，不论男女老少，不论资历深浅&lt;/p&gt;
&lt;p&gt;迄今为止我看到的老师和学生的关系几乎没有平等的，都是老师是农场主，学生是农场里的畜牲，或许是我的见识太少了，所以我暂时把这个理论当成“暴论”看待&lt;/p&gt;
&lt;p&gt;老师对学生的影响太大了，这是一个承前启后继往开来的职业，但在人们口中成了什么？公务员的下位替代品？编制？铁饭碗？这和因为大学期间荒废学业玩游戏去了而不是因为想做出令人感动的游戏所以去做游戏开发相关工作有什么两样？！&lt;/p&gt;
&lt;p&gt;“喻轶啊，假如你成绩不好找不到工作，那就去当老师吧。”&lt;/p&gt;
&lt;p&gt;这是我的某个当老师的亲戚的原话，后面同样在学校工作的我爸也复述了很多遍&lt;/p&gt;
&lt;p&gt;孔夫子在九泉之下若是有知&amp;hellip;&lt;/p&gt;
&lt;h2 id=&#34;后记&#34;&gt;后记
&lt;/h2&gt;&lt;p&gt;唯物主义，唯心主义，理想主义，现实主义，虚无主义&amp;hellip;&lt;/p&gt;
&lt;p&gt;我且问你一个问题，你怎么定义“思想”？&lt;/p&gt;
&lt;p&gt;要我看，思想本质上是工具，它是一种思维定式，但不能定义任何一个具体观点&lt;/p&gt;
&lt;p&gt;任何人都拥有自己的一套思想，好比马克思有马克思主义，我有喻轶主义，但你要问我喻轶主义是什么，我也总结不出来，但马克思可以把他的主义总结出来&lt;/p&gt;
&lt;p&gt;我可以在任何使用使用任何主义来佐证我的观点，或者阐明我的立场，或为我解决问题&lt;/p&gt;
&lt;p&gt;就好比我在思考未来时，我是一个理想主义者，我有那么多的理想要实现，要加把劲，在思考现在时，我是现实主义者，我要清楚地知道我是谁，我能做什么，在思考过去时，我是一个虚无主义者，我认为过去既然无法改变，那就让它躺在那吧，反正世界是虚无的，我不需要为过去的自己悲伤&lt;/p&gt;
&lt;p&gt;最后，大学生好像都要上一门心理健康课对吧（说老实话，我觉得这个课非常浪费时间，从宏观角度讲弊大于利），在某堂课上，老师要求我们写关于“我是谁”的短句，最少好像是20个吧，我不记得了，在此，我想用我写的这些短句给这篇长文作结（或许它与前文某些地方会冲突，但请不要管这些细节）&lt;/p&gt;
&lt;h3 id=&#34;我是&#34;&gt;我是
&lt;/h3&gt;&lt;p&gt;我是人&lt;/p&gt;
&lt;p&gt;我是一个中考失利的人&lt;/p&gt;
&lt;p&gt;我是一个靠自学翻身的人&lt;/p&gt;
&lt;p&gt;我是一个不依附于他人的人&lt;/p&gt;
&lt;p&gt;我是一个不服从权威的人&lt;/p&gt;
&lt;p&gt;我是一个有梦想的人&lt;/p&gt;
&lt;p&gt;我是一个理想主义者&lt;/p&gt;
&lt;p&gt;我是一个唯物主义者&lt;/p&gt;
&lt;p&gt;我是一个想做二把手的人&lt;/p&gt;
&lt;p&gt;我是一个对自己要求高的人&lt;/p&gt;
&lt;p&gt;我是一个经常焦虑的人&lt;/p&gt;
&lt;p&gt;我是一个失去初恋的人&lt;/p&gt;
&lt;p&gt;我是一个不相信命运的人&lt;/p&gt;
&lt;p&gt;我是一个对人平等的人&lt;/p&gt;
&lt;p&gt;我是一个挑战上位者的人&lt;/p&gt;
&lt;p&gt;我是一个不服输的人&lt;/p&gt;
&lt;p&gt;我是一个不惜代价的人&lt;/p&gt;
&lt;p&gt;我是一个有悲悯之心的人&lt;/p&gt;
&lt;p&gt;我是一个从痛苦中获得乐趣的人&lt;/p&gt;
&lt;p&gt;我是一个追求自由的人&lt;/p&gt;
</description>
        </item>
        <item>
        <title>有限状态机</title>
        <link>http://localhost:1313/p/%E6%9C%89%E9%99%90%E7%8A%B6%E6%80%81%E6%9C%BA/</link>
        <pubDate>Fri, 11 Apr 2025 00:00:00 +0000</pubDate>
        
        <guid>http://localhost:1313/p/%E6%9C%89%E9%99%90%E7%8A%B6%E6%80%81%E6%9C%BA/</guid>
        <description>&lt;h2 id=&#34;前言&#34;&gt;前言
&lt;/h2&gt;&lt;p&gt;我在使用godot开发一个RTS游戏的时候，我突然发现游戏中的单位(Unit)有且仅有三个动作（当时没有考虑&amp;quot;状态&amp;quot;，而是直接将这些定义为动作）：静止，移动，攻击，或者他们的组合（比如边移动边攻击，当然，别和我杠边静止边移动）&lt;/p&gt;
&lt;p&gt;然后就诞生了这样一个无限递归函数的流程图：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://localhost:1313/p/%E6%9C%89%E9%99%90%E7%8A%B6%E6%80%81%E6%9C%BA/%E7%8A%B6%E6%80%81%E6%9C%BA%E6%80%BB%E7%BB%931.jpg&#34;
	width=&#34;1920&#34;
	height=&#34;1352&#34;
	srcset=&#34;http://localhost:1313/p/%E6%9C%89%E9%99%90%E7%8A%B6%E6%80%81%E6%9C%BA/%E7%8A%B6%E6%80%81%E6%9C%BA%E6%80%BB%E7%BB%931_hu_e7e11bcb33e95b20.jpg 480w, http://localhost:1313/p/%E6%9C%89%E9%99%90%E7%8A%B6%E6%80%81%E6%9C%BA/%E7%8A%B6%E6%80%81%E6%9C%BA%E6%80%BB%E7%BB%931_hu_58f12fda764299fd.jpg 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;状态机总结1&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;142&#34;
		data-flex-basis=&#34;340px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;可nb了，当时我就觉得，wow，我简直是一个逻辑大王，直到我知道这么做会栈溢出&amp;hellip;&lt;/p&gt;
&lt;p&gt;然后就去学了状态机，把上面的逻辑通过状态机写成了这样：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://localhost:1313/p/%E6%9C%89%E9%99%90%E7%8A%B6%E6%80%81%E6%9C%BA/%E7%8A%B6%E6%80%81%E6%9C%BA%E6%80%BB%E7%BB%932.jpg&#34;
	width=&#34;1920&#34;
	height=&#34;1093&#34;
	srcset=&#34;http://localhost:1313/p/%E6%9C%89%E9%99%90%E7%8A%B6%E6%80%81%E6%9C%BA/%E7%8A%B6%E6%80%81%E6%9C%BA%E6%80%BB%E7%BB%932_hu_e62bdb37d68f0d4b.jpg 480w, http://localhost:1313/p/%E6%9C%89%E9%99%90%E7%8A%B6%E6%80%81%E6%9C%BA/%E7%8A%B6%E6%80%81%E6%9C%BA%E6%80%BB%E7%BB%932_hu_60e09c4624021ee6.jpg 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;状态机总结2&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;175&#34;
		data-flex-basis=&#34;421px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;他们两个看上去逻辑是一样的，但区别就在上面的不能用，下面的能用，所以，状态机有什么用？&lt;/p&gt;
&lt;p&gt;即答：让不能用的东西变得能用！（bushi&lt;/p&gt;
&lt;p&gt;答：让actor个体（你说GameObject或CharacterBody也行，主要是我从虚幻开始学的，用actor习惯了）的行为用状态表示，从而&lt;strong&gt;减少逻辑混乱，增强代码可维护性和可扩展性&lt;/strong&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;用硬代码实现状态机&#34;&gt;用硬代码实现状态机
&lt;/h2&gt;&lt;h3 id=&#34;逻辑&#34;&gt;逻辑
&lt;/h3&gt;&lt;p&gt;想象一下，我们只有一个enemy场景，和一个附着在enemy根节点上的脚本，这个脚本要全权负责enmey的巡逻，追逐，攻击逻辑（经典的patrol-chase-attack循环），我们该怎么写？&lt;/p&gt;
&lt;p&gt;既然用状态机，那么我们就把这三个变成状态吧，我们有巡逻状态，追逐状态，攻击状态，自然，我们需要一个&lt;strong&gt;枚举&lt;/strong&gt;来存储这个分类，还要有一个变量来存储&lt;strong&gt;当前状态&lt;/strong&gt;，嗯，好，记得要做这两个&lt;/p&gt;
&lt;p&gt;然后我们要处理一下动画，我们得三个状态显然要有不同的动画，那么我们就可以在更改当前状态时同步更改它的动画，那么要记得&lt;strong&gt;在更改状态的函数中同步更新动画&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;再者让我们想想，我们要怎么样更改状态呢，比如从patrol转到chase？或许你有许多种方法，比如添加一个Area2D然后把它的area_entered信号连接到根节点脚本中，但我们在这里还是只谈脚本中处理的方法&lt;/p&gt;
&lt;p&gt;那么我们就需要知道玩家在哪，敌人在哪，当玩家与敌人近到一定程度时就更改状态，这里我们用硬代码直接在tick里写，&lt;strong&gt;当我们的当前状态为patrol时，实时获取玩家与敌人位置，当二者距离小于侦查距离时，转换状态为chase&lt;/strong&gt;，chase到attack的转换同理，&lt;strong&gt;二者距离小于攻击距离时，立刻攻击玩家，然后状态转为patrol&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;以上，一个硬代码状态机就实现了，好了，那么纸上谈兵结束了，现在自己对照下面的代码看上面的解释吧&lt;/p&gt;
&lt;h3 id=&#34;实现&#34;&gt;实现
&lt;/h3&gt;&lt;p&gt;那么就用一下硬代码实现一下状态机吧&lt;/p&gt;
&lt;p&gt;这个硬代码是我从YouTube上一个老哥的博客学来的（啥不是学来的嘞，你说是不吼），以下是原帖，我改成了更简单的版本（原版是scanning-firing-charging循环，但我改成我觉得更简单易懂的patrol-chase-attack循环）&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://shaggydev.com/2023/10/08/godot-4-state-machines/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Godot 4 中的启动状态机 - The Shaggy Dev &amp;mdash; Starter state machines in Godot 4 - The Shaggy Dev&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;（这个文章里同时有硬代码方法和进阶状态机方法，看上半部分就行）&lt;/p&gt;
&lt;p&gt;（记住，不要用硬代码写状态机，除非你敢拿头保证你不会增加很多很复杂的状态或复合状态！）&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-gdscript3&#34; data-lang=&#34;gdscript3&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;extends&lt;/span&gt; &lt;span class=&#34;ne&#34;&gt;Node&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;enum&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;STATE&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;PATROL&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;CHASE&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;ATTACK&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;#在此定义状态机中的所有状态&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;@&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Player&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;PLAYER&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;#对玩家引用来判断是否在侦查范围内&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;current_state&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;STATE&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;PATROL&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;#定义&amp;#34;当前状态&amp;#34;并赋初始值为PATROL&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;@&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;animation&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;AnimatedSprite2D&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;#这个动画状态机没有任何架构上的意义，你可以不用管它，我只是想突出状态应该要有的enter函数而已，让我的那个更改状态的函数变得不那么蠢&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;@&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;detect_distance&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;ne&#34;&gt;float&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;#侦查范围&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;@&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;attack_distance&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;ne&#34;&gt;float&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;#攻击范围&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;change_state&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;new_state&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;STATE&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#更改状态的函数&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;current_state&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;new_state&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;match&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;current_state&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;n&#34;&gt;STATE&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;PATROL&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;n&#34;&gt;animation&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;play&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;patrol&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;n&#34;&gt;STATE&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;CHASE&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;n&#34;&gt;animation&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;play&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;chase&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;n&#34;&gt;STATE&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ATTACK&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;n&#34;&gt;animation&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;play&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;attack&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;n&#34;&gt;change_state&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;STATE&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;PATROL&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;c1&#34;&gt;#这三个match结果就是播放对应的动画&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;_process&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;delta&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;match&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;current_state&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;n&#34;&gt;STATE&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;PATROL&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Player&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;position&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;distance_to&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;position&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;detect_distance&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;				&lt;span class=&#34;n&#34;&gt;change_state&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;STATE&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;CHASE&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;n&#34;&gt;STATE&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;CHASE&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Player&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;position&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;distance_to&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;position&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;attack_distance&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;				&lt;span class=&#34;n&#34;&gt;change_state&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;STATE&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ATTACK&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;_physics_process&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;delta&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;match&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;current_state&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;c1&#34;&gt;#这下面的函数我就不写了，毕竟重心不在实现enemy动作，而是实现状态机的结构&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;n&#34;&gt;STATE&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;PATROL&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;n&#34;&gt;random_move&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;n&#34;&gt;STATE&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;CHASE&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;n&#34;&gt;move_to_player&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Player&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;n&#34;&gt;STATE&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ATTACK&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;n&#34;&gt;attack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Player&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;结束了，框架没了，是不是很简单？对，状态机就是这么简单&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;用statemachine父节点state类子节点实现状态机&#34;&gt;用StateMachine父节点+STATE类子节点实现状态机
&lt;/h2&gt;&lt;h3 id=&#34;约定俗成&#34;&gt;约定俗成
&lt;/h3&gt;&lt;p&gt;知道了上面硬代码实现状态机的方法，有一些东西我就不重复了，知识直接extends过来就ok&lt;/p&gt;
&lt;p&gt;现在我们讲讲一个&lt;strong&gt;状态&lt;/strong&gt;应该有什么&lt;/p&gt;
&lt;p&gt;什么？什么叫应该有什么？这是什么意思？意思就是&lt;strong&gt;状态&lt;/strong&gt;这个东西的规范形式&lt;/p&gt;
&lt;p&gt;它会有四个函数，分别是&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Enter()
在状态改变为当前状态时调用，抽象理解为godot中的_enter_tree()&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Exit()
在离开该状态时调用，理解为_exit_tree()&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Update()
与状态机的_process()绑定调用，用于处理渲染&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Physics_Update()
与状态机的_physics_process()绑定调用，用于处理逻辑&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;以上都是约定俗成，但我觉得它们应该能对你理解接下来的代码有点帮助&lt;/p&gt;
&lt;h3 id=&#34;实现与理解&#34;&gt;实现与理解
&lt;/h3&gt;&lt;p&gt;以下是我适应的在godot中使用的状态机写法&lt;/p&gt;
&lt;p&gt;原帖&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://www.youtube.com/watch?v=ow_Lum-Agbs&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Finite State Machines in Godot 4 in Under 10 Minutes - YouTube&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;首先定义STATE这个东西，我们得知道STATE是什么，有什么默认函数（定义STATE类）&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-gdscript3&#34; data-lang=&#34;gdscript3&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#STATE.gd&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;extends&lt;/span&gt; &lt;span class=&#34;ne&#34;&gt;Node&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;class_name&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;STATE&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;#这里就是定义STATE&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;signal&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ChangeState&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;#在要更改状态时发出信号，这个信号将附带有将要转向的状态的字符串形式，然后我们在状态机中用字符串查找到的状态来替换当前状态&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Enter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;#这个函数将在进入该状态时调用&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;pass&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Exit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;#在退出该状态时调用&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;pass&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Update&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;delta&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;#和_process绑定，用于处理渲染tick&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;pass&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Physics_Update&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;delta&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;#和_physics_process绑定，用于处理逻辑tick&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;pass&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;为什么上面的函数都是空的？&lt;/p&gt;
&lt;p&gt;因为后面会根据状态不同直接覆盖这些函数&lt;/p&gt;
&lt;p&gt;然后就是状态机了，先想想状态机应该有什么？&lt;/p&gt;
&lt;p&gt;状态机得：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;初始化状态（如果有）&lt;/li&gt;
&lt;li&gt;知道能有几种状态（状态的字典）&lt;/li&gt;
&lt;li&gt;知道当前状态是什么（知道当前要执行哪个状态的函数）&lt;/li&gt;
&lt;li&gt;能改变状态（有改变状态的函数）&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;没了！那就写吧！&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-gdscript3&#34; data-lang=&#34;gdscript3&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#StateMachine.gd&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;extends&lt;/span&gt; &lt;span class=&#34;ne&#34;&gt;Node&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;class_name&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;state_machine&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;state_dictionary&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{}&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;#这里是2&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;current_state&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;STATE&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;#这里是3&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;@&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;init_state&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;STATE&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;#这里是1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;_ready&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;c1&#34;&gt;#这里是2&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;child&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;get_children&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;child&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;is&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;STATE&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;n&#34;&gt;state_dictionary&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;child&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;to_lower&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;child&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;#状态字典，键为状态的小写字符串形式，值为状态（子节点），这里的小写是用于保证代码安全的写法，避免因为大小写不同而检索不到相应的状态名&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;n&#34;&gt;child&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;change_state&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;connect&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;_change_state&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;#绑定信号到函数&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;c1&#34;&gt;#这里是1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;init_state&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;n&#34;&gt;current_state&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;init_state&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;n&#34;&gt;current_state&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Enter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#这里是3&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;_process&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;delta&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;current_state&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;n&#34;&gt;current_state&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Update&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;delta&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;_physics_process&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;delta&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;current_state&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;n&#34;&gt;current_state&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Physics_Update&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;delta&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#这里是4&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;_change_state&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;new_state&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;current_state&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;n&#34;&gt;current_state&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Exit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;current_state&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;state_dictionary&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;new_state&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;current_state&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Enter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;接下来用patrol-chase-attack循环来演示状态节点&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-gdscript3&#34; data-lang=&#34;gdscript3&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#patrol.gd&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;extends&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;STATE&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;class_name&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;PATROL&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;@&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;enemy&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ENEMY&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;#这里是用引用的方法来让根节点实现当前状态的逻辑的&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;@&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;player&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;PLAYER&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;#引用Player检测玩家是否进入侦查距离&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;detect_distance&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;ne&#34;&gt;float&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;#侦查距离，当玩家与敌人的距离小于这一距离时，更改状态为chase&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;wander_time&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;ne&#34;&gt;float&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;#为了不用✓十timer，这里用最朴素的方法写计时器&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;current_wander_time&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;ne&#34;&gt;float&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;random_move&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;pass&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;c1&#34;&gt;#这里我就不演示了，反正就是enemy的运动逻辑&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Enter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;random_move&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Update&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;delta&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;wander_time&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;n&#34;&gt;current_wander_time&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;delta&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;n&#34;&gt;random_move&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;n&#34;&gt;current_wander_time&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;wander_time&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;_Physics_Update&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;delta&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;c1&#34;&gt;#当玩家与敌人距离比侦查距离小时，将状态转换为chase&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;player&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;position&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;distance_to&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;position&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;detect_distance&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;n&#34;&gt;change_state&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;emit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;chase&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;以上&lt;/p&gt;
&lt;p&gt;这个状态机的思路就是：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;给根节点一个节点StateMachine&lt;/li&gt;
&lt;li&gt;在StateMachine下添加STATE类节点&lt;/li&gt;
&lt;li&gt;StateMachine实时调用current_state的逻辑&lt;/li&gt;
&lt;li&gt;STATE节点获得对StateMachine的引用实现更改current_state逻辑&lt;/li&gt;
&lt;li&gt;STATE节点获得对根节点的引用实现STATE逻辑&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id=&#34;依赖注入的状态机写法&#34;&gt;依赖注入的状态机写法
&lt;/h2&gt;&lt;p&gt;下面写一个进阶的状态机写法，原帖也是上面的那个，这个的代码我是直接抄来的，但注释是我自己写的&lt;/p&gt;
&lt;h3 id=&#34;玩家&#34;&gt;玩家
&lt;/h3&gt;&lt;p&gt;首先我们需要一个CharacterBody2D作为根节点的场景&lt;/p&gt;
&lt;p&gt;然后我们给它一个AnimatedSprite2D和CollisionShape2D，这个不在状态机的架构范围里，我们就不谈这个了&lt;/p&gt;
&lt;p&gt;然后给根节点附加一个脚本，在里面这样写&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-gdscript3&#34; data-lang=&#34;gdscript3&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#player.gd&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;class_name&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Player&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;#声明节点类，当然，不声明的话后面引用CharacterBody2D类也行的&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;extends&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;CharacterBody2D&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;@&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;onready&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;animations&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;$&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;animations&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;@&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;onready&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;state_machine&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;$&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;state_machine&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#这两个引用看看就好，应该知道是引用的是什么&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#接下来是经典的绑定状态机环节&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;_ready&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;void&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;state_machine&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;init&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;_unhandled_inputs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;event&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;ne&#34;&gt;InputEvent&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;#这个是绑定未处理的输入事件，一般我们会直接在process里监听玩家输入，这里随你吧&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;state_machine&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;process_input&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;event&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;_physics_process&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;delta&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;ne&#34;&gt;float&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;state_machine&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;process_physics&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;delta&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;#处理物理tick&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;_process&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;delta&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;ne&#34;&gt;float&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;state_machine&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;process_frame&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;delta&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;#处理渲染tick&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;状态机&#34;&gt;状态机
&lt;/h3&gt;&lt;p&gt;由于状态本质上是Player的&amp;quot;热插拔大脑&amp;quot;，所以这里就相当于子节点控制父节点&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-gdscript3&#34; data-lang=&#34;gdscript3&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#state_machine.gd&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;extends&lt;/span&gt; &lt;span class=&#34;ne&#34;&gt;Node&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;@&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;export&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;starting_state&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;State&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#初始化状态机的状态&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;current_state&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;State&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#存储当前状态的变量&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;init&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;parent&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Player&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;void&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;child&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;get_children&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;():&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;n&#34;&gt;child&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;parent&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;parent&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;c1&#34;&gt;#这里的child是附加在状态机下面的状态子节点，这里的parent是函数的输入参数，同时你再往上看，在Player的_ready()里调用了这个函数并将Player节点的self传过来了，那么这里就相当于一个桥梁，把Player的slef（对自身的引用，也就是根节点）再传给所有状态的parent变量中&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;change_state&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;starting_state&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;c1&#34;&gt;#初始化状态机的状态&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;change_state&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;new_state&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;State&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;void&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#改变状态的函数&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;current_state&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;n&#34;&gt;current_state&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;exit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;c1&#34;&gt;#假如当前有状态，执行状态的exit函数&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;current_state&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;new_state&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;current_state&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;enter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;c1&#34;&gt;#将当前状态设置为新状态，执行新状态的enter函数&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#这些函数的解释看后文&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;process_physics&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;delta&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;ne&#34;&gt;float&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;void&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;new_state&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;current_state&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;process_physics&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;delta&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;new_state&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;n&#34;&gt;change_state&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;new_state&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;process_input&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;event&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;ne&#34;&gt;InputEvent&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;void&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;new_state&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;current_state&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;process_input&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;event&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;new_state&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;n&#34;&gt;change_state&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;new_state&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;process_frame&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;delta&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;ne&#34;&gt;float&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;void&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;new_state&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;current_state&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;process_frame&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;delta&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;new_state&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;n&#34;&gt;change_state&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;new_state&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;看上面的三段函数你可能会很疑惑，绑定函数你懂，那为什么会有一个改变状态的函数？每次调用状态的函数后都要改变状态？&lt;/p&gt;
&lt;p&gt;不，仔细一点看，这里是和我写的状态机不同的结构，看看声明的变量是什么，是状态中的绑定函数的返回值！那就意味着什么？这段代码在表达什么？&lt;/p&gt;
&lt;p&gt;假如需要改变状态，那么状态的process_input，process_frame，process_physics三个函数会返回要改变的状态，反之这个返回值将会为空，那么就不会调用if判断里的改变状态函数&lt;/p&gt;
&lt;p&gt;这里和依赖注入的关系不大，但我相信你可以理解的&lt;/p&gt;
&lt;h3 id=&#34;状态父类&#34;&gt;状态父类
&lt;/h3&gt;&lt;p&gt;所有的state仍然要作一个类（毕竟你也看到了，在状态机里面的状态就是以State类型变量保存的）&lt;/p&gt;
&lt;p&gt;以下是State的脚本&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-gdscript3&#34; data-lang=&#34;gdscript3&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;class_name&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;State&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;extends&lt;/span&gt; &lt;span class=&#34;ne&#34;&gt;Node&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;@&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;export&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;animation_name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;ne&#34;&gt;String&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#这一行代码提示我们，这是个夹杂了动画的状态机，但没关系，都是状态机，思想是通用的&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;@&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;export&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;move_speed&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;ne&#34;&gt;float&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;300&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#设置玩家的移动速度，没有架构意义&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;gravity&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;ne&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ProjectSettings&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;get_setting&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;physics/2d/default_gravity&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#获取重力，没有架构意义&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;parent&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Player&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#往前看状态机，在状态机初始化时，这个变量就会是Player根节点&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;enter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;void&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;parent&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;animations&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;play&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;animation_name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;exit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;void&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;pass&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;process_input&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;event&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;ne&#34;&gt;InputEvent&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;State&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;null&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;process_frame&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;delta&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;ne&#34;&gt;float&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;State&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;null&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;process_physics&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;delta&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;ne&#34;&gt;float&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;State&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;null&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#上面这些默认函数看看就好，反正就是这么个结构，我主张写的那个状态机不也是差不多这样嘛&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;或许你想问为什么不直接绑定godot的自带函数_process()和_physics_process()啥的，作者表示这是个人喜好，可以明确知道自己正在写什么内容&lt;/p&gt;
&lt;h3 id=&#34;状态子类&#34;&gt;状态子类
&lt;/h3&gt;&lt;p&gt;接下来就是几个状态实例了，很明显，他们都挺简单的&lt;/p&gt;
&lt;p&gt;这是闲置状态&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-gdscript3&#34; data-lang=&#34;gdscript3&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#idle.gd&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;extends&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;State&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;@&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;export&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;fall_state&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;State&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;@&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;export&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;jump_state&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;State&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;@&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;export&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;move_state&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;State&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#这些状态的引用都要在编辑器的inspector里注入&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;enter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;void&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;super&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;c1&#34;&gt;#有关super()函数，请看后面的正文&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;parent&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;velocity&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;c1&#34;&gt;#毕竟这是idle，所以要把速度设为0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;process_input&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;event&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;ne&#34;&gt;InputEvent&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;State&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;ne&#34;&gt;Input&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;is_action_just_pressed&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;jump&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;and&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;parent&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;is_on_floor&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;():&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;jump_state&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;c1&#34;&gt;#假如按下了jump相关按键，并且玩家在地板上，那么就转换状态为jump_state&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;ne&#34;&gt;Input&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;is_action_just_pressed&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;move_left&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;or&lt;/span&gt; &lt;span class=&#34;ne&#34;&gt;Input&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;is_action_just_pressed&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;move_right&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;move_state&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;c1&#34;&gt;#看了上面的你也应该懂这行了吧&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;null&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;c1&#34;&gt;#默认什么都不返回，注意，返回什么，就会转换成什么状态，如果不理解，看上面的状态机&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;process_physics&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;delta&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;ne&#34;&gt;float&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;State&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;parent&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;velocity&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;y&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;gravity&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;delta&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;parent&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;move_and_slide&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;c1&#34;&gt;#这里呃，你可以想象一个斜坡，玩家站在斜坡上时会因为重力作用而下滑，这里可不是和jump时模拟重力有关哦，注意这是idle状态，不会影响jump状态的&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;parent&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;is_on_floor&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;():&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;fall_state&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;null&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;补充一个知识点，super()就是调用父类中的同名函数的函数，扩展的，super.函数名()则是调用父类中的相应函数&lt;/p&gt;
&lt;p&gt;接下来是跳跃状态&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-gdscript3&#34; data-lang=&#34;gdscript3&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# jump.gd&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;extends&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;State&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;@&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;export&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;fall_state&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;State&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;@&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;export&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;idle_state&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;State&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;@&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;export&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;move_state&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;State&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#可以看的出来，作者是将所有可能转去的状态都引用到了这个脚本中，这个在我的那个状态机里是通过初始化遍历子节点创建字典+通过字符串键在字典中查询状态值的方法来做的&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;@&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;export&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;jump_force&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;ne&#34;&gt;float&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;700.0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;enter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;void&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;super&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;parent&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;velocity&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;y&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;jump_force&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;c1&#34;&gt;#将根节点的y速度设置为跳跃初始速度（为什么是负？因为负才是往上）&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;process_physics&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;delta&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;ne&#34;&gt;float&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;State&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;parent&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;velocity&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;y&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;gravity&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;delta&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;c1&#34;&gt;#处理重力的物理模拟，因为godot的物理模拟很差，所以自己写物理&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;parent&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;velocity&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;y&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;fall_state&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;c1&#34;&gt;#假如y速度小于0了，就是在下落了&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;movement&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;ne&#34;&gt;Input&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;get_axis&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;move_left&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;move_right&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;move_speed&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;c1&#34;&gt;#这个有关空中左右移动，你可能会想，move_speed没有在这里声明啊，看看State父类，默认声明了&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;movement&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;n&#34;&gt;parent&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;animations&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;flip_h&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;movement&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;c1&#34;&gt;#注意flip_h是有关图像翻转的&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;parent&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;velocity&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;movement&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;parent&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;move_and_slide&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;parent&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;is_on_floor&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;():&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;movement&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;move_state&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;idle_state&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;null&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;以上&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;接下来&#34;&gt;接下来？
&lt;/h2&gt;&lt;p&gt;哦好吧，我们必须得承认这只是状态机的冰山一角&lt;/p&gt;
&lt;p&gt;试想一下，假如我们要做一个这个功能：&lt;/p&gt;
&lt;p&gt;冲刺(dash)：向前方快速移动一段距离&lt;/p&gt;
&lt;p&gt;你应该注意到了，我们完全可以基于walk这个状态来更改（别问我为什么上面没提这个状态，你就不能想象一下嘛），所以，在此我们会希望给状态机添加一个子状态机，这个状态机可能叫MovementMachine，然后在它里面处理dash和walk的关系&lt;/p&gt;
&lt;p&gt;这叫&lt;strong&gt;分层状态机&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;假如我们要让一个角色边移动边攻击呢？两个状态同时执行？&lt;/p&gt;
&lt;p&gt;这叫&lt;strong&gt;并发状态机&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;基本原理就是在分层状态机中父状态机绑定子状态机process那一步分别调用所有子状态机的process&lt;/p&gt;
&lt;p&gt;还有，假如我要设置一个规则：角色在跳跃时不能攻击？&lt;/p&gt;
&lt;p&gt;涉及状态机间的通信（或者说类似于&lt;strong&gt;黑板&lt;/strong&gt;这样的行为树里有的东西）&lt;/p&gt;
&lt;p&gt;这些我们后面细嗦&lt;/p&gt;
</description>
        </item>
        <item>
        <title>归档</title>
        <link>http://localhost:1313/archives/</link>
        <pubDate>Tue, 28 May 2019 00:00:00 +0000</pubDate>
        
        <guid>http://localhost:1313/archives/</guid>
        <description></description>
        </item>
        <item>
        <title>关于</title>
        <link>http://localhost:1313/%E5%85%B3%E4%BA%8E/</link>
        <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
        
        <guid>http://localhost:1313/%E5%85%B3%E4%BA%8E/</guid>
        <description>&lt;p&gt;联系我：&lt;/p&gt;
&lt;p&gt;EMAIL:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;mailto:yy1973100@163.com&#34; &gt;yy1973100@163.com&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;mailto:1204146126@qq.com&#34; &gt;1204146126@qq.com&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Github: &lt;a class=&#34;link&#34; href=&#34;https://github.com/yuyi-yutie&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://github.com/yuyi-yutie&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;WeChat: qfwj-yutie1973100&lt;/p&gt;
&lt;p&gt;QQ: 1204146126&lt;/p&gt;
</description>
        </item>
        <item>
        <title>链接</title>
        <link>http://localhost:1313/%E9%93%BE%E6%8E%A5/</link>
        <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
        
        <guid>http://localhost:1313/%E9%93%BE%E6%8E%A5/</guid>
        <description></description>
        </item>
        <item>
        <title>搜索</title>
        <link>http://localhost:1313/search/</link>
        <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
        
        <guid>http://localhost:1313/search/</guid>
        <description></description>
        </item>
        
    </channel>
</rss>
